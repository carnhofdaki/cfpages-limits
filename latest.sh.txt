#!/bin/sh
#
# No limits for prunednode.today, worldwide fast
# Courtesy of CloudFlare (now free of IPFS, at least
# for us on this level)
#
# This is a shell script which downloads all the files
# one by one and joins them to the original latest.zip
# for which Stepan's signature is made.
#
# Requirements: wget, cat, rm

URL=https://cfpages-limits.pages.dev

> latest.zip
wget -qO - $URL/files.txt | while read file
do
  echo "Processing file $file..."
  wget -qO $file $URL/$file
  cat $file >> latest.zip
  rm -rf $file
done

wget $URL/latest.signed.txt
SN=$(grep -oE 'snapshot[0-9]{6}.zip' latest.signed.txt)
ln latest.zip $SN
sha256sum -c --ignore-missing latest.signed.txt
